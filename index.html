<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
<title>Booha Speak & Repeat – January Week 1</title>
<meta name="theme-color" content="#0b1530" />
<link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@700;900&family=Noto+Sans+JP:wght@500;700&display=swap" rel="stylesheet" />
<style>
:root{
  --bg:#0b1530; --ink:#fff; --outline:#ffffff26; --radius:26px;
  --pink:#ff7eb9; --blue:#7dd3fc; --yell:#fff680;
}
*{box-sizing:border-box}
body{margin:0;background:var(--bg);color:var(--ink);font-family:system-ui,"Noto Sans JP",sans-serif;overflow-x:hidden;}

header{text-align:center;padding:20px 12px 12px}
.h1{font-family:'Cinzel',serif;font-weight:900;font-size:clamp(30px,6vw,50px);}

.wrap{max-width:1000px;margin:0 auto;padding:20px}
.panel{padding:20px;border:1px solid var(--outline);border-radius:var(--radius);background:rgba(255,255,255,.05);}
.card{position:relative;border:1px solid var(--outline);border-radius:var(--radius);padding:22px;margin-bottom:10px;overflow:hidden;}
.en{position:relative;font-weight:900;font-size:clamp(24px,6vw,44px);text-align:center;z-index:2;}
.en .word{display:inline-block;padding:0 .06em;color:#fff;transition:color .3s ease, transform .3s ease;position:relative;}
.en .word.black{color:#000}
.en .word.blue{color:#00aaff;}

.sweep{position:absolute;top:0;left:-100%;width:100%;height:100%;background:var(--yell);opacity:.9;transition:left 3s linear;z-index:1;}
.heart{position:absolute;font-size:clamp(18px,4vw,28px);color:var(--pink);opacity:0;animation:heartUp 1s ease-out forwards;}
@keyframes heartUp{0%{transform:translateY(0) scale(1);opacity:1;}100%{transform:translateY(-60px) scale(1.6);opacity:0;}}

.btnRow{display:flex;align-items:center;justify-content:center;gap:10px;margin-top:20px;flex-wrap:wrap}
.btn{display:inline-grid;place-items:center;padding:14px 24px;border:none;border-radius:999px;font-weight:900;font-size:clamp(18px,4vw,22px);background:radial-gradient(circle at 30% 30%, #1ee99a,#15c473,#0ea85d);cursor:pointer;}
.btn.retry{background:radial-gradient(circle at 30% 30%, #8ec5ff,#4da0ff,#1e6eff);}

footer{text-align:center;color:#c9d4ec;font-family:'Cinzel',serif;font-weight:700;padding:30px 10px}
</style>
</head>
<body>
<header><div class="h1">THE BOO-RICULUM<br>SPEAK &amp; REPEAT</div></header>
<div class="wrap">
  <div class="panel">
    <div class="card">
      <div id="sweep" class="sweep"></div>
      <div id="en" class="en">Press はじめる to start</div>
    </div>
    <div class="btnRow">
      <button id="beginBtn" class="btn">はじめる<br><small>Begin</small></button>
      <button id="retryBtn" class="btn retry" style="display:none">もう一回<br><small>Retry</small></button>
    </div>
  </div>
</div>
<footer>Bryan’s English School</footer>
<script>
const QUESTIONS=[
"What is your goal this year?","Why is it important to you?","How will you reach your goal?","Who helps you stay motivated?","What habit do you want to change?","Do you like making resolutions?","What do you want to try this year?","What’s something new you learned recently?","Is it easy to keep goals?","What happens when you don’t try?","What makes you feel proud?","What’s your dream for the future?","How do you stay positive?","Who inspires you?","How can English help your goals?"
];
let idx=0,wordsMeta=[],score=0;
const enEl=document.getElementById('en');
const sweep=document.getElementById('sweep');
const beginBtn=document.getElementById('beginBtn');
const retryBtn=document.getElementById('retryBtn');

function mountWords(text){const parts=text.split(/\s+/).filter(Boolean);enEl.innerHTML=parts.map(w=>`<span class='word'>${w}</span>`).join(' ');wordsMeta=[...enEl.querySelectorAll('.word')];}
function startSweep(){sweep.style.left='-100%';sweep.style.opacity=0.9;setTimeout(()=>{sweep.style.left='0';},50);setTimeout(()=>{sweep.style.left='100%';},3100);setTimeout(()=>{sweep.style.opacity=0;},3300);}
function triggerHeart(wordEl){const heart=document.createElement('span');heart.className='heart';heart.textContent='❤';enEl.appendChild(heart);const rect=wordEl.getBoundingClientRect();const parentRect=enEl.getBoundingClientRect();heart.style.left=(rect.left-parentRect.left+rect.width/2)+'px';heart.style.top=(rect.top-parentRect.top)+'px';setTimeout(()=>heart.remove(),1000);}
function onWordSpoken(spoken){let correctCount=0;for(const w of wordsMeta){if(spoken.toLowerCase().includes(w.textContent.toLowerCase())){if(!w.classList.contains('blue')){w.classList.add('blue');triggerHeart(w);}correctCount++;}}score=Math.round((correctCount/wordsMeta.length)*100);}

function startListening(){
  const SR=(window.SpeechRecognition||window.webkitSpeechRecognition)?new (window.SpeechRecognition||window.webkitSpeechRecognition)():null;
  if(!SR){alert('音声認識が利用できません。Chrome または Edge を使用してください。');return;}
  SR.lang='en-US';SR.continuous=true;SR.interimResults=true;
  SR.onresult=(e)=>{let txt='';for(let i=e.resultIndex;i<e.results.length;i++){txt+=e.results[i][0].transcript+' ';}onWordSpoken(txt.trim());};
  SR.onend=()=>{if(score>=100){nextQuestion();}else{retryBtn.style.display='inline-grid';}};
  SR.start();
  startSweep();
  setTimeout(()=>{SR.stop();},3000);
}

function nextQuestion(){idx++;retryBtn.style.display='none';if(idx<QUESTIONS.length){mountWords(QUESTIONS[idx]);startListening();}else{enEl.innerHTML='Great work today! All 15 done!';}}

beginBtn.addEventListener('click',()=>{idx=0;mountWords(QUESTIONS[idx]);startListening();});
retryBtn.addEventListener('click',()=>{retryBtn.style.display='none';mountWords(QUESTIONS[idx]);startListening();});
</script>
</body>
</html>
